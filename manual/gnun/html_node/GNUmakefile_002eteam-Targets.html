<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- 
This manual (updated 20 December 2018) is for GNUnited Nations (version
0.12), a suite for maintaining translations of www.gnu.org
essays and other articles.


Copyright (C) 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2016,
2018 Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled "GNU Free
Documentation License." -->
<!-- Created by GNU Texinfo 5.2, http://www.gnu.org/software/texinfo/ -->
<head>
<title>GNUnited Nations: GNUmakefile.team Targets</title>

<meta name="description" content="GNUnited Nations: GNUmakefile.team Targets">
<meta name="keywords" content="GNUnited Nations: GNUmakefile.team Targets">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="Top">
<link href="Index.html#Index" rel="index" title="Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Team_0027s-Repository.html#Team_0027s-Repository" rel="up" title="Team's Repository">
<link href="GNUmakefile_002eteam-and-Cron.html#GNUmakefile_002eteam-and-Cron" rel="next" title="GNUmakefile.team and Cron">
<link href="GNUmakefile_002eteam-Variables.html#GNUmakefile_002eteam-Variables" rel="prev" title="GNUmakefile.team Variables">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.indentedblock {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
div.smalllisp {margin-left: 3.2em}
kbd {font-style:oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:nowrap}
span.nolinebreak {white-space:nowrap}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">
<a name="GNUmakefile_002eteam-Targets"></a>
<div class="header">
<p>
Next: <a href="GNUmakefile_002eteam-and-Cron.html#GNUmakefile_002eteam-and-Cron" accesskey="n" rel="next">GNUmakefile.team and Cron</a>, Previous: <a href="GNUmakefile_002eteam-Variables.html#GNUmakefile_002eteam-Variables" accesskey="p" rel="prev">GNUmakefile.team Variables</a>, Up: <a href="Team_0027s-Repository.html#Team_0027s-Repository" accesskey="u" rel="up">Team's Repository</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Targets-in-GNUmakefile_002eteam"></a>
<h3 class="section">3.2 Targets in <samp>GNUmakefile.team</samp></h3>

<dl compact="compact">
<dt><code>update-team</code></dt>
<dd><p>Updates the working copy of team&rsquo;s repository.
</p>
</dd>
<dt><code>update-www</code></dt>
<dd><p>Updates the working copy of <em>www</em>.
</p>
</dd>
<dt><code>update</code></dt>
<dd><p>A shortcut for making <code>update-team</code> and <code>update-www</code>.
</p>
</dd>
<dt><code>sync</code></dt>
<dd><p>Merges all available PO files from the corresponding POT in <em>www</em>.
If a POT is missing in the master repository (usually, because it was
deleted when the original article was either split, renamed or deleted),
a warning is printed for the corresponding file and no merging occurs
for it.
</p>
</dd>
<dt><code>report</code></dt>
<dd><a name="report-in-GNUmakefile_002eteam"></a><p>Verifies which translations are complete, and prints a list (with
statistics) of those that need to be updated.  Also, it reports
the translations that are not consistent with the revisions from
<em>www</em> repository.
</p>
<p>More fine-grained notifications are implemented as the <code>notify</code>
target.
</p>
</dd>
<dt><code>notify</code></dt>
<dd><a name="notify-in-GNUmakefile_002eteam"></a><a name="index-outdated-translations_002c-notifications"></a>
<p>Invokes the <code>report</code> target, filters its output for different
translators and sends them notifications.
</p>
<p>As an addition to the output of the <code>report</code> target, URLs for
relevant files are written; also, when <em>www</em> and team revisions
are not consistent, their differences generated with
<code>gnun-diff-po</code> are optionally attached (see <a href="gnun_002ddiff_002dpo.html#gnun_002ddiff_002dpo">gnun-diff-po</a>,
for more details).
</p>
<a name="index-nottab"></a>
<p>The list of files to report against are configured with <samp>nottab</samp>
file.  The lines of this file that begin with &lsquo;#&rsquo; are ignored;
other lines should contain two fields separated by &lsquo;:&rsquo;.
</p>
<p>The first field is an extended grep regular expression; the files are
selected for the report if their names match this expression.
See <a href="http://www.gnu.org/software/grep/manual/html_node/Regular-Expressions.html#Regular-Expressions">Regular Expressions</a> in <cite>GNU Grep manual</cite>.
</p>
<p>The second field is a space-separated list of single-word translators&rsquo;
identifiers for which the line applies.  The file may look like this:
</p>
<div class="example">
<pre class="example">^gnu/gnu-history: alice bob carol
^distros/(common-distros|distros|screenshot): dan alice
^(licenses|philosophy)/: eve bob frank
^licenses/: dan
</pre></div>

<a name="index-email_002daliases"></a>
<p>Email addresses of the translators are kept in a separate file,
<samp>email-aliases</samp>.  Like in <samp>nottab</samp>, the lines beginning
with &lsquo;#&rsquo; are ignored; other lines contain fields separated by &lsquo;:&rsquo;.
</p>
<p>The first field is the translator&rsquo;s identifier, the second is
space-separated list of translator&rsquo;s email addresses.  These two
fields are mandatory.
</p>
<a name="index-reminder-period"></a>
<a name="index-notification-period"></a>
<p>The third field is the personal reminder period in days.  After that
period the message is sent again even though its contents don&rsquo;t
change.  Otherwise, the <code>notify</code> target only sends messages when
something changes.  Naturally, no message is sent when no action
is needed in the requested set of translations (unless the
<code>force</code> option is used).
</p>
<p>The team-wide default period is defined in its GNUmakefile.team using
the <code>NOTIFICATION_PERIOD</code> variable.
</p>
<p>The fourth field provides comma-separated options for the report.
Currently recognized options are:
</p>
<dl compact="compact">
<dt><code>force</code></dt>
<dd><p>Forces sending messages even when there are no files to work on.
</p>
</dd>
<dt><code>no-diffs</code></dt>
<dd><p>Disables sending <em>www</em> vs. <em>www-<var>lang</var></em> differences
as attachments.
</p>
</dd>
<dt><code>www</code></dt>
<dd><p>Report cases that suggest actions by the team leader, that is,
when the translation in the team repository is complete whereas
in <em>www</em> it is incomplete or absent.
</p></dd>
</dl>

<p>This is an example of <samp>email-aliases</samp>:
</p>
<div class="example">
<pre class="example">alice:alice@example.com abc@test.net
# Disable `dan' temporarily.
#dan:miller@test.by:5:no-diffs,www
bob:brh@invalid.tr:3
# Note that the third field is empty; the default value for period
# will be used.
carol:carol@localhost.br translator@example.bg::no-diffs
eve:eve@test.gr:2:www
frank:gnun-notifications@example.gr:1:www,no-diffs
</pre></div>

<p>The <samp>email-aliases</samp> file should be kept privately because it
may contain personal email addresses of people.  How to do this
is out of scope of GNUN and this manual.
</p>
</dd>
<dt><code>format</code></dt>
<dd><p>A convenience rule to re-wrap all files up to the standard length.  Many
PO editors leave the <code>msgstr</code> as a single long line after it has
been edited, but GNUN will automatically re-wrap the file to the standard
line length when it is processed.  Wrapping long lines in PO files is a
good practice as it avoids unnecessary revisions.
</p>
<p>This rule filters all translations with <code>msgcat</code>; basically,
it reformats the lines that are longer than the default page width
of <code>msgcat</code>.
</p>
</dd>
<dt><code>publish</code></dt>
<dd><a name="publish"></a><p>The <code>publish</code> rule&rsquo;s task is to copy all modified files to the
official <em>www</em> repository.  It depends on the <code>format</code> target
to ensure that all files are re-wrapped to the standard line length
limit, but deliberately does not depend on <code>sync VCS=yes</code>.
Usually, one would run <code>make publish</code> when one or a bunch of PO
files are in a satisfactory condition to be published, and this rule is
just a convenience to avoid multiple manual <code>cp</code> invocations.
As a rule of thumb, before running this rule it is sane to run
<code>sync</code> and correct any &ldquo;fuzzy&rdquo; messages and other problems, if
necessary.
</p>
<p>The <code>publish</code> rule does not depend on <code>sync</code> explicitly,
because that would be a nuisance for offline operations and basically
unnecessary when the committer is fairly confident that there are no
changes to (re-)merge.  A hard dependency on <code>sync</code> would slow down
the operation considerably.
</p>
<p>As usual, when committing to the official repository, it is always a
good practice to examine the output of <code>cvs diff</code>.
</p>
<p>Invoking <code>make publish</code> prints warnings and does not actually copy
the affected file if the sub-directory in &ldquo;www&rdquo; is non-existent or the
corresponding <samp>.pot</samp> is missing.
</p>
<p>Typically, after an editing session (whether it involves actual editing
or just merging contributions from team members), one would do:
</p>
<div class="example">
<pre class="example">$ make sync VCS=yes
$ make publish
$ cd <var>wwwdir</var>
$ cvs up
(Add all new translations, if any.)
  $ cvs add <var>file</var> &hellip;
$ cvs diff
$ cvs commit -m &quot;Some descriptive message.&quot;
</pre></div>

</dd>
<dt><code>clean</code></dt>
<dd><p>Deletes all backup and auto-generated files.
</p></dd>
</dl>

<p><code>make VCS=yes</code> is the recommended command to be run periodically.
To check the status of the translations, run <code>make report</code>.
</p>
<p>Feel free to replace all strings with equivalents in your native
language and of course&mdash;do not hesitate to extend this file and
modify it as much as you like.  If you come up with
something interesting, it would be nice to send a message to
<a href="mailto:bug-gnun@gnu.org">bug-gnun@gnu.org</a>, so that <samp>GNUmakefile.team</samp> gets
updated for all teams&rsquo; benefit.
</p>
<hr>
<div class="header">
<p>
Next: <a href="GNUmakefile_002eteam-and-Cron.html#GNUmakefile_002eteam-and-Cron" accesskey="n" rel="next">GNUmakefile.team and Cron</a>, Previous: <a href="GNUmakefile_002eteam-Variables.html#GNUmakefile_002eteam-Variables" accesskey="p" rel="prev">GNUmakefile.team Variables</a>, Up: <a href="Team_0027s-Repository.html#Team_0027s-Repository" accesskey="u" rel="up">Team's Repository</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Index.html#Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
